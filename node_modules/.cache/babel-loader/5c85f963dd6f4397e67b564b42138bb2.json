{"ast":null,"code":"import { PureComponent as o } from \"react\";\nimport e from \"prop-types\";\nimport n from \"@mapbox/mapbox-gl-geocoder\";\nimport { FlyToInterpolator as r } from \"react-map-gl\";\nimport t from \"viewport-mercator-project\";\nimport i from \"mapbox-gl\";\n\nvar c = [\"top-left\", \"top-right\", \"bottom-left\", \"bottom-right\"],\n    l = function (o) {\n  var e, l;\n\n  function a() {\n    for (var e, l = arguments.length, a = new Array(l), u = 0; u < l; u++) a[u] = arguments[u];\n\n    return (e = o.call.apply(o, [this].concat(a)) || this).geocoder = null, e.cachedResult = null, e.initializeGeocoder = function () {\n      var o = e.getMapboxMap(),\n          r = e.getContainerNode(),\n          t = e.props,\n          l = t.inputValue,\n          a = t.render,\n          u = t.getItemValue,\n          s = t.onInit,\n          d = t.position,\n          p = {\n        accessToken: t.mapboxApiAccessToken,\n        origin: t.origin,\n        zoom: t.zoom,\n        flyTo: !1,\n        placeholder: t.placeholder,\n        proximity: t.proximity,\n        trackProximity: t.trackProximity,\n        collapsed: t.collapsed,\n        clearAndBlurOnEsc: t.clearAndBlurOnEsc,\n        clearOnBlur: t.clearOnBlur,\n        bbox: t.bbox,\n        types: t.types,\n        countries: t.countries,\n        minLength: t.minLength,\n        limit: t.limit,\n        language: t.language,\n        filter: t.filter,\n        localGeocoder: t.localGeocoder,\n        reverseGeocode: t.reverseGeocode,\n        enableEventLogging: t.enableEventLogging,\n        marker: t.marker,\n        mapboxgl: i\n      };\n      a && \"function\" == typeof a && (p.render = a), u && \"function\" == typeof u && (p.getItemValue = u), e.geocoder = new n(p), e.subscribeEvents(), r ? r.appendChild(e.geocoder.onAdd(o)) : o.addControl(e.geocoder, c.find(function (o) {\n        return d === o;\n      })), null != l ? e.geocoder.setInput(l) : e.cachedResult && e.geocoder.setInput(e.cachedResult.place_name), (e.cachedResult || null != l) && e.showClearIcon(), s(e.geocoder);\n    }, e.showClearIcon = function () {\n      e.geocoder._clearEl.style.display = \"block\";\n    }, e.getMapboxMap = function () {\n      var o = e.props.mapRef;\n      return o && o.current && o.current.getMap() || null;\n    }, e.getContainerNode = function () {\n      var o = e.props.containerRef;\n      return o && o.current || null;\n    }, e.subscribeEvents = function () {\n      e.geocoder.on(\"clear\", e.handleClear), e.geocoder.on(\"loading\", e.handleLoading), e.geocoder.on(\"results\", e.handleResults), e.geocoder.on(\"result\", e.handleResult), e.geocoder.on(\"error\", e.handleError);\n    }, e.unsubscribeEvents = function () {\n      e.geocoder.off(\"clear\", e.handleClear), e.geocoder.off(\"loading\", e.handleLoading), e.geocoder.off(\"results\", e.handleResults), e.geocoder.off(\"result\", e.handleResult), e.geocoder.off(\"error\", e.handleError);\n    }, e.removeGeocoder = function () {\n      var o = e.getMapboxMap();\n      e.unsubscribeEvents(), o && o.removeControl && e.getMapboxMap().removeControl(e.geocoder), e.geocoder = null;\n    }, e.handleClear = function () {\n      e.cachedResult = null, e.props.onClear();\n    }, e.handleLoading = function (o) {\n      e.props.onLoading(o);\n    }, e.handleResults = function (o) {\n      e.props.onResults(o);\n    }, e.handleResult = function (o) {\n      var n = o.result,\n          i = e.props,\n          c = i.onViewportChange,\n          l = i.onResult,\n          a = n.bbox,\n          u = n.center,\n          s = n.properties,\n          d = (void 0 === s ? {} : s).short_code,\n          p = u[0],\n          g = u[1],\n          f = {\n        fr: {\n          name: \"France\",\n          bbox: [[-4.59235, 41.380007], [9.560016, 51.148506]]\n        },\n        us: {\n          name: \"United States\",\n          bbox: [[-171.791111, 18.91619], [-66.96466, 71.357764]]\n        },\n        ru: {\n          name: \"Russia\",\n          bbox: [[19.66064, 41.151416], [190.10042, 81.2504]]\n        },\n        ca: {\n          name: \"Canada\",\n          bbox: [[-140.99778, 41.675105], [-52.648099, 83.23324]]\n        }\n      },\n          m = e.getMapboxMap().getContainer().getBoundingClientRect(),\n          h = m.width,\n          b = m.height,\n          x = e.geocoder.options.zoom,\n          v = function (o, e) {\n        return new t(e).fitBounds(o);\n      };\n\n      try {\n        !f[d] && a ? x = v([[a[0], a[1]], [a[2], a[3]]], {\n          width: h,\n          height: b\n        }).zoom : f[d] && (x = v(f[d].bbox, {\n          width: h,\n          height: b\n        }).zoom);\n      } catch (o) {\n        console.warn(\"following result caused an error when trying to zoom to bbox: \", n), x = e.geocoder.options.zoom;\n      }\n\n      c({\n        longitude: p,\n        latitude: g,\n        zoom: x,\n        transitionInterpolator: new r(),\n        transitionDuration: 3e3\n      }), l(o), e.cachedResult = n, e.geocoder._typeahead.selected = null, e.showClearIcon();\n    }, e.handleError = function (o) {\n      e.props.onError(o);\n    }, e;\n  }\n\n  l = o, (e = a).prototype = Object.create(l.prototype), e.prototype.constructor = e, e.__proto__ = l;\n  var u = a.prototype;\n  return u.componentDidMount = function () {\n    this.initializeGeocoder();\n  }, u.componentWillUnmount = function () {\n    this.removeGeocoder();\n  }, u.componentDidUpdate = function () {\n    this.removeGeocoder(), this.initializeGeocoder();\n  }, u.getGeocoder = function () {\n    return this.geocoder;\n  }, u.render = function () {\n    return null;\n  }, a;\n}(o);\n\nl.propTypes = {\n  mapRef: e.object.isRequired,\n  containerRef: e.object,\n  onViewportChange: e.func,\n  mapboxApiAccessToken: e.string.isRequired,\n  inputValue: e.string,\n  origin: e.string,\n  zoom: e.number,\n  placeholder: e.string,\n  proximity: e.object,\n  trackProximity: e.bool,\n  collapsed: e.bool,\n  clearAndBlurOnEsc: e.bool,\n  clearOnBlur: e.bool,\n  bbox: e.array,\n  types: e.string,\n  countries: e.string,\n  minLength: e.number,\n  limit: e.number,\n  language: e.string,\n  filter: e.func,\n  localGeocoder: e.func,\n  reverseGeocode: e.bool,\n  enableEventLogging: e.bool,\n  marker: e.bool,\n  render: e.func,\n  getItemValue: e.func,\n  position: e.oneOf(c),\n  onInit: e.func,\n  onClear: e.func,\n  onLoading: e.func,\n  onResults: e.func,\n  onResult: e.func,\n  onError: e.func\n}, l.defaultProps = {\n  onViewportChange: function () {},\n  origin: \"https://api.mapbox.com\",\n  zoom: 16,\n  placeholder: \"Search\",\n  trackProximity: !1,\n  collapsed: !1,\n  clearAndBlurOnEsc: !1,\n  clearOnBlur: !1,\n  minLength: 2,\n  limit: 5,\n  reverseGeocode: !1,\n  enableEventLogging: !0,\n  marker: !0,\n  position: \"top-right\",\n  onInit: function () {},\n  onClear: function () {},\n  onLoading: function () {},\n  onResults: function () {},\n  onResult: function () {},\n  onError: function () {}\n};\nexport default l;","map":{"version":3,"sources":["../src/index.js"],"names":["VALID_POSITIONS","Geocoder","PureComponent","geocoder","cachedResult","componentDidMount","this","initializeGeocoder","componentWillUnmount","removeGeocoder","componentDidUpdate","mapboxMap","_this","getMapboxMap","containerNode","getContainerNode","mapboxApiAccessToken","inputValue","origin","zoom","placeholder","proximity","trackProximity","collapsed","clearAndBlurOnEsc","clearOnBlur","bbox","types","countries","minLength","limit","language","filter","localGeocoder","reverseGeocode","enableEventLogging","marker","render","getItemValue","onInit","position","props","options","accessToken","flyTo","mapboxgl","MapboxGeocoder","subscribeEvents","appendChild","onAdd","addControl","find","_position","setInput","place_name","showClearIcon","_clearEl","style","display","mapRef","current","getMap","containerRef","on","handleClear","handleLoading","handleResults","handleResult","handleError","unsubscribeEvents","off","removeControl","onClear","event","onLoading","onResults","result","onViewportChange","onResult","center","properties","short_code","longitude","latitude","bboxExceptions","fr","name","us","ru","ca","width","height","getContainer","getBoundingClientRect","fitBounds","bounds","viewport","WebMercatorViewport","e","console","warn","transitionInterpolator","FlyToInterpolator","transitionDuration","_typeahead","selected","onError","getGeocoder","propTypes","PropTypes","object","isRequired","func","string","number","bool","array","oneOf","defaultProps"],"mappings":"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","sourcesContent":["import { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder'\nimport { FlyToInterpolator } from 'react-map-gl'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport mapboxgl from 'mapbox-gl'\n\nconst VALID_POSITIONS = ['top-left', 'top-right', 'bottom-left', 'bottom-right']\n\nclass Geocoder extends PureComponent {\n  geocoder = null\n  cachedResult = null\n\n  componentDidMount() {\n    this.initializeGeocoder()\n  }\n\n  componentWillUnmount() {\n    this.removeGeocoder()\n  }\n\n  componentDidUpdate() {\n    this.removeGeocoder()\n    this.initializeGeocoder()\n  }\n\n  initializeGeocoder = () => {\n    const mapboxMap = this.getMapboxMap()\n    const containerNode = this.getContainerNode()\n    const {\n      mapboxApiAccessToken,\n      inputValue,\n      origin,\n      zoom,\n      placeholder,\n      proximity,\n      trackProximity,\n      collapsed,\n      clearAndBlurOnEsc,\n      clearOnBlur,\n      bbox,\n      types,\n      countries,\n      minLength,\n      limit,\n      language,\n      filter,\n      localGeocoder,\n      reverseGeocode,\n      enableEventLogging,\n      marker,\n      render,\n      getItemValue,\n      onInit,\n      position\n    } = this.props\n    const options = {\n      accessToken: mapboxApiAccessToken,\n      origin,\n      zoom,\n      flyTo: false,\n      placeholder,\n      proximity,\n      trackProximity,\n      collapsed,\n      clearAndBlurOnEsc,\n      clearOnBlur,\n      bbox,\n      types,\n      countries,\n      minLength,\n      limit,\n      language,\n      filter,\n      localGeocoder,\n      reverseGeocode,\n      enableEventLogging,\n      marker,\n      mapboxgl\n    }\n\n    if (render && typeof render === 'function') {\n      options.render = render\n    }\n\n    if (getItemValue && typeof getItemValue === 'function') {\n      options.getItemValue = getItemValue\n    }\n\n    this.geocoder = new MapboxGeocoder(options)\n    this.subscribeEvents()\n\n    if (containerNode) {\n      containerNode.appendChild(this.geocoder.onAdd(mapboxMap))\n    } else {\n      mapboxMap.addControl(this.geocoder, VALID_POSITIONS.find((_position) => position === _position))\n    }\n\n    if (inputValue !== undefined && inputValue !== null) {\n      this.geocoder.setInput(inputValue)\n    } else if (this.cachedResult) {\n      this.geocoder.setInput(this.cachedResult.place_name)\n    }\n\n    if (this.cachedResult || (inputValue !== undefined && inputValue !== null)) {\n      this.showClearIcon()\n    }\n\n    onInit(this.geocoder)\n  }\n\n  showClearIcon = () => {\n    // this is a hack to force clear icon to show if there is text in the input\n    this.geocoder._clearEl.style.display = 'block'\n  }\n\n  getMapboxMap = () => {\n    const { mapRef } = this.props\n\n    return (mapRef && mapRef.current && mapRef.current.getMap()) || null\n  }\n\n  getContainerNode = () => {\n    const { containerRef } = this.props\n\n    return (containerRef && containerRef.current) || null\n  }\n\n  subscribeEvents = () => {\n    this.geocoder.on('clear', this.handleClear)\n    this.geocoder.on('loading', this.handleLoading)\n    this.geocoder.on('results', this.handleResults)\n    this.geocoder.on('result', this.handleResult)\n    this.geocoder.on('error', this.handleError)\n  }\n\n  unsubscribeEvents = () => {\n    this.geocoder.off('clear', this.handleClear)\n    this.geocoder.off('loading', this.handleLoading)\n    this.geocoder.off('results', this.handleResults)\n    this.geocoder.off('result', this.handleResult)\n    this.geocoder.off('error', this.handleError)\n  }\n\n  removeGeocoder = () => {\n    const mapboxMap = this.getMapboxMap()\n\n    this.unsubscribeEvents()\n\n    if (mapboxMap && mapboxMap.removeControl) {\n      this.getMapboxMap().removeControl(this.geocoder)\n    }\n\n    this.geocoder = null\n  }\n\n  handleClear = () => {\n    this.cachedResult = null\n    this.props.onClear()\n  }\n\n  handleLoading = (event) => {\n    this.props.onLoading(event)\n  }\n\n  handleResults = (event) => {\n    this.props.onResults(event)\n  }\n\n  handleResult = (event) => {\n    const { result } = event\n    const { onViewportChange, onResult } = this.props\n    const { bbox, center, properties = {} } = result\n    const { short_code } = properties\n    const [longitude, latitude] = center\n    const bboxExceptions = {\n      fr: {\n        name: 'France',\n        bbox: [[-4.59235, 41.380007], [9.560016, 51.148506]]\n      },\n      us: {\n        name: 'United States',\n        bbox: [[-171.791111, 18.91619], [-66.96466, 71.357764]]\n      },\n      ru: {\n        name: 'Russia',\n        bbox: [[19.66064, 41.151416], [190.10042, 81.2504]]\n      },\n      ca: {\n        name: 'Canada',\n        bbox: [[-140.99778, 41.675105], [-52.648099, 83.23324]]\n      }\n    }\n    const { width, height } = this.getMapboxMap()\n      .getContainer()\n      .getBoundingClientRect()\n    let zoom = this.geocoder.options.zoom\n    const fitBounds = (bounds, viewport) => new WebMercatorViewport(viewport).fitBounds(bounds)\n\n    try {\n      if (!bboxExceptions[short_code] && bbox) {\n        zoom = fitBounds([[bbox[0], bbox[1]], [bbox[2], bbox[3]]], { width, height }).zoom\n      } else if (bboxExceptions[short_code]) {\n        zoom = fitBounds(bboxExceptions[short_code].bbox, { width, height }).zoom\n      }\n    } catch (e) {\n      console.warn('following result caused an error when trying to zoom to bbox: ', result) // eslint-disable-line\n      zoom = this.geocoder.options.zoom\n    }\n\n    onViewportChange({\n      longitude,\n      latitude,\n      zoom,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionDuration: 3000\n    })\n    onResult(event)\n\n    this.cachedResult = result\n    this.geocoder._typeahead.selected = null\n    this.showClearIcon()\n  }\n\n  handleError = (event) => {\n    this.props.onError(event)\n  }\n\n  getGeocoder() {\n    return this.geocoder\n  }\n\n  render() {\n    return null\n  }\n\n  static propTypes = {\n    mapRef: PropTypes.object.isRequired,\n    containerRef: PropTypes.object,\n    onViewportChange: PropTypes.func,\n    mapboxApiAccessToken: PropTypes.string.isRequired,\n    inputValue: PropTypes.string,\n    origin: PropTypes.string,\n    zoom: PropTypes.number,\n    placeholder: PropTypes.string,\n    proximity: PropTypes.object,\n    trackProximity: PropTypes.bool,\n    collapsed: PropTypes.bool,\n    clearAndBlurOnEsc: PropTypes.bool,\n    clearOnBlur: PropTypes.bool,\n    bbox: PropTypes.array,\n    types: PropTypes.string,\n    countries: PropTypes.string,\n    minLength: PropTypes.number,\n    limit: PropTypes.number,\n    language: PropTypes.string,\n    filter: PropTypes.func,\n    localGeocoder: PropTypes.func,\n    reverseGeocode: PropTypes.bool,\n    enableEventLogging: PropTypes.bool,\n    marker: PropTypes.bool,\n    render: PropTypes.func,\n    getItemValue: PropTypes.func,\n    position: PropTypes.oneOf(VALID_POSITIONS),\n    onInit: PropTypes.func,\n    onClear: PropTypes.func,\n    onLoading: PropTypes.func,\n    onResults: PropTypes.func,\n    onResult: PropTypes.func,\n    onError: PropTypes.func\n  }\n\n  static defaultProps = {\n    onViewportChange: () => {},\n    origin: 'https://api.mapbox.com',\n    zoom: 16,\n    placeholder: 'Search',\n    trackProximity: false,\n    collapsed: false,\n    clearAndBlurOnEsc: false,\n    clearOnBlur: false,\n    minLength: 2,\n    limit: 5,\n    reverseGeocode: false,\n    enableEventLogging: true,\n    marker: true,\n    position: 'top-right',\n    onInit: () => {},\n    onClear: () => {},\n    onLoading: () => {},\n    onResults: () => {},\n    onResult: () => {},\n    onError: () => {}\n  }\n}\n\nexport default Geocoder\n"]},"metadata":{},"sourceType":"module"}