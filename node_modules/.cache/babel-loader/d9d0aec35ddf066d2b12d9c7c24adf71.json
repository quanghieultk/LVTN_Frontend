{"ast":null,"code":"import axios from 'axios';\nimport { authHeader } from '../helpers/auth-header';\nexport const chatService = {\n  sendMessage,\n  getChatRooms,\n  getMessagesForRoom\n};\n\nfunction logout() {\n  // remove user from local storage to log user out\n  localStorage.removeItem(\"user\");\n}\n\nfunction getChatRooms(parmams) {\n  return axios.post(\"http://localhost:8000/api/chats/getChatRooms/\", null, {\n    headers: authHeader()\n  });\n}\n\nfunction readMessages(params) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: JSON.stringify({ ...params\n    })\n  };\n  return fetch(\"/api/chat/readMessages/\", requestOptions).then(handleResponse).then(res => {\n    return res;\n  });\n}\n\nfunction getMessagesForRoom(room) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: JSON.stringify({ ...room\n    })\n  };\n  return fetch(\"/api/chat/getMessagesForRoom/\", requestOptions).then(handleResponse).then(res => {\n    return res;\n  });\n}\n\nfunction sendMessage(params) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: JSON.stringify({ ...params\n    })\n  };\n  return axios(\"localhost:8000/api/chats/sendMessage\", requestOptions).then(res => {\n    return JSON.parse(res);\n  });\n}\n\nfunction sendImage(data) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: data\n  };\n  return fetch(\"/api/chat/sendImage/\", requestOptions).then(handleResponse).then(res => {\n    return res;\n  });\n}\n\nfunction call(data) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: JSON.stringify({ ...data\n    })\n  };\n  return fetch(\"/api/chat/call/\", requestOptions).then(handleResponse).then(res => {\n    return res;\n  });\n}\n\nfunction answer(data) {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: JSON.parse(localStorage.getItem(\"user\")).token\n    },\n    body: JSON.stringify({ ...data\n    })\n  };\n  return fetch(\"/api/chat/answer/\", requestOptions).then(handleResponse).then(res => {\n    return res;\n  });\n}\n\nfunction handleResponse(response) {\n  return response.text().then(text => {\n    const data = text && JSON.parse(text);\n\n    if (!response.ok) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        logout();\n        window.location.reload(true);\n      }\n\n      const error = data && data.message || response.statusText;\n      return Promise.reject(error);\n    }\n\n    return data;\n  });\n}","map":{"version":3,"sources":["D:/LVTN/LVTN/cuisine-net/src/services/chat.service.js"],"names":["axios","authHeader","chatService","sendMessage","getChatRooms","getMessagesForRoom","logout","localStorage","removeItem","parmams","post","headers","readMessages","params","requestOptions","method","Authorization","JSON","parse","getItem","token","body","stringify","fetch","then","handleResponse","res","room","sendImage","data","call","answer","response","text","ok","status","window","location","reload","error","message","statusText","Promise","reject"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { authHeader } from '../helpers/auth-header';\r\n\r\nexport const chatService = {\r\n    sendMessage,\r\n    getChatRooms,\r\n    getMessagesForRoom\r\n}\r\nfunction logout() {\r\n    // remove user from local storage to log user out\r\n    localStorage.removeItem(\"user\");\r\n}\r\nfunction getChatRooms(parmams) {\r\n    return axios.post(\"http://localhost:8000/api/chats/getChatRooms/\",null,{headers : authHeader()})\r\n}\r\n\r\nfunction readMessages(params) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: JSON.stringify({\r\n            ...params\r\n        })\r\n    };\r\n\r\n    return fetch(\"/api/chat/readMessages/\", requestOptions)\r\n        .then(handleResponse)\r\n        .then(res => {\r\n            return res;\r\n        });\r\n}\r\n\r\nfunction getMessagesForRoom(room) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: JSON.stringify({\r\n            ...room\r\n        })\r\n    };\r\n\r\n    return fetch(\"/api/chat/getMessagesForRoom/\", requestOptions)\r\n        .then(handleResponse)\r\n        .then(res => {\r\n            return res;\r\n        });\r\n}\r\n\r\nfunction sendMessage(params) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: JSON.stringify({\r\n            ...params\r\n        })\r\n    };\r\n\r\n    return axios(\"localhost:8000/api/chats/sendMessage\", requestOptions)\r\n        .then(res => {\r\n            return JSON.parse(res);\r\n        });\r\n}\r\n\r\n\r\nfunction sendImage(data) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: data\r\n    };\r\n\r\n    return fetch(\"/api/chat/sendImage/\", requestOptions)\r\n        .then(handleResponse)\r\n        .then(res => {\r\n            return res;\r\n        });\r\n}\r\n\r\nfunction call(data) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: JSON.stringify({\r\n            ...data\r\n        })\r\n    };\r\n\r\n    return fetch(\"/api/chat/call/\", requestOptions)\r\n        .then(handleResponse)\r\n        .then(res => {\r\n            return res;\r\n        });\r\n}\r\n\r\n\r\n\r\nfunction answer(data) {\r\n    const requestOptions = {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: JSON.parse(localStorage.getItem(\"user\")).token\r\n        },\r\n        body: JSON.stringify({\r\n            ...data\r\n        })\r\n    };\r\n\r\n    return fetch(\"/api/chat/answer/\", requestOptions)\r\n        .then(handleResponse)\r\n        .then(res => {\r\n            return res;\r\n        });\r\n}\r\n\r\n\r\n\r\nfunction handleResponse(response) {\r\n    return response.text().then(text => {\r\n        const data = text && JSON.parse(text);\r\n        if (!response.ok) {\r\n            if (response.status === 401) {\r\n                // auto logout if 401 response returned from api\r\n                logout();\r\n                window.location.reload(true);\r\n            }\r\n\r\n            const error = (data && data.message) || response.statusText;\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return data;\r\n    });\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}